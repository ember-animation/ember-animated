{"version":3,"file":"resize.js","sources":["../../src/motions/resize.ts"],"sourcesContent":["import { rAF } from '../-private/concurrency-helpers.ts';\nimport Motion, { type BaseOptions } from '../-private/motion.ts';\nimport Tween, { type DerivedTween } from '../-private/tween.ts';\nimport type Sprite from '../-private/sprite.ts';\n\ninterface Options extends BaseOptions {\n  easing: (t: number) => number;\n}\n\n/**\n  Smoothly resizes _sprite_ from its the initial size to its final size.\n\n  _sprite_ must have both `initialBounds` and `finalBounds` set.\n\n  Consider using `scale` instead because scale uses CSS transforms and will not trigger reflow.\n\n  ```js\n  for (let sprite of insertedSprites) {\n    sprite.startAtSprite(beacons['source']);\n    resize(sprite)\n  }\n  ```\n\n  @function resize\n  @export default\n  @param {Sprite} sprite\n  @return {Motion}\n*/\nexport default function resize(sprite: Sprite, opts: Partial<Options> = {}) {\n  return new Resize(sprite, opts).run();\n}\n\nexport class Resize extends Motion<Options> {\n  prior: Resize | null = null;\n  widthTween: Tween | DerivedTween | null = null;\n  heightTween: Tween | DerivedTween | null = null;\n\n  interrupted(motions: Motion[]) {\n    let prior = motions.find((m) => m instanceof this.constructor);\n    if (prior) {\n      this.prior = prior as Resize;\n    }\n  }\n\n  *animate() {\n    let sprite: Sprite = this.sprite;\n    let duration = this.duration;\n    let widthTween: Tween | DerivedTween;\n    let heightTween: Tween | DerivedTween;\n\n    sprite.assertHasInitialBounds();\n    sprite.assertHasFinalBounds();\n\n    if (!this.prior) {\n      widthTween = this.widthTween = new Tween(\n        sprite.initialBounds.width / sprite.initialCumulativeTransform.a,\n        sprite.finalBounds.width / sprite.finalCumulativeTransform.a,\n        duration,\n        this.opts.easing,\n      );\n      heightTween = this.heightTween = new Tween(\n        sprite.initialBounds.height / sprite.initialCumulativeTransform.d,\n        sprite.finalBounds.height / sprite.finalCumulativeTransform.d,\n        duration,\n        this.opts.easing,\n      );\n    } else {\n      widthTween = this.widthTween = new Tween(\n        0,\n        sprite.finalBounds.width / sprite.finalCumulativeTransform.a -\n          this.prior.sprite.finalBounds!.width,\n        duration,\n        this.opts.easing,\n      ).plus(this.prior.widthTween!);\n      heightTween = this.heightTween = new Tween(\n        0,\n        sprite.finalBounds.height / sprite.finalCumulativeTransform.d -\n          this.prior.sprite.finalBounds!.height,\n        duration,\n        this.opts.easing,\n      ).plus(this.prior.heightTween!);\n    }\n\n    while (!widthTween.done || !heightTween.done) {\n      sprite.applyStyles({\n        width: `${widthTween.currentValue}px`,\n        height: `${heightTween.currentValue}px`,\n      });\n      yield rAF();\n    }\n  }\n}\n"],"names":["resize","sprite","opts","Resize","run","Motion","constructor","args","_defineProperty","interrupted","motions","prior","find","m","animate","duration","widthTween","heightTween","assertHasInitialBounds","assertHasFinalBounds","Tween","initialBounds","width","initialCumulativeTransform","a","finalBounds","finalCumulativeTransform","easing","height","d","plus","done","applyStyles","currentValue","rAF"],"mappings":"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"}