{"version":3,"file":"child.js","sources":["../../src/-private/child.ts"],"sourcesContent":["export default class Child<T = unknown> {\n  state: 'new' | 'kept' | 'removing' = 'new';\n  private removalBlockers = 0;\n  private removalCycle: number | null = null;\n\n  constructor(\n    readonly group: string,\n    readonly id: string,\n    readonly value: T,\n    readonly index: number,\n  ) {\n    this.removalBlockers = 0;\n    this.removalCycle = null;\n  }\n\n  block(cycle: number) {\n    if (this.removalCycle == null || this.removalCycle === cycle) {\n      this.removalCycle = cycle;\n      this.removalBlockers++;\n    }\n  }\n\n  unblock(cycle: number) {\n    if (this.removalCycle === cycle) {\n      this.removalBlockers--;\n    }\n  }\n\n  flagForRemoval() {\n    this.removalCycle = null;\n    this.removalBlockers = 0;\n    this.state = 'removing';\n  }\n\n  get shouldRemove() {\n    return this.state === 'removing' && this.removalBlockers < 1;\n  }\n\n  clone() {\n    return new Child(this.group, this.id, this.value, this.index);\n  }\n}\n"],"names":["Child","state","removalBlockers","removalCycle","constructor","group","id","value","index","block","cycle","unblock","flagForRemoval","shouldRemove","clone"],"mappings":"AAAe,MAAMA,KAAK,CAAc;AACtCC,EAAAA,KAAK,GAAgC,KAAK;AAClCC,EAAAA,eAAe,GAAG,CAAC;AACnBC,EAAAA,YAAY,GAAkB,IAAI;EAE1CC,WAAWA,CACAC,KAAa,EACbC,EAAU,EACVC,KAAQ,EACRC,KAAa,EACtB;IAAA,IAJSH,CAAAA,KAAa,GAAbA,KAAa;IAAA,IACbC,CAAAA,EAAU,GAAVA,EAAU;IAAA,IACVC,CAAAA,KAAQ,GAARA,KAAQ;IAAA,IACRC,CAAAA,KAAa,GAAbA,KAAa;IAEtB,IAAI,CAACN,eAAe,GAAG,CAAC;IACxB,IAAI,CAACC,YAAY,GAAG,IAAI;AAC1B;EAEAM,KAAKA,CAACC,KAAa,EAAE;IACnB,IAAI,IAAI,CAACP,YAAY,IAAI,IAAI,IAAI,IAAI,CAACA,YAAY,KAAKO,KAAK,EAAE;MAC5D,IAAI,CAACP,YAAY,GAAGO,KAAK;MACzB,IAAI,CAACR,eAAe,EAAE;AACxB;AACF;EAEAS,OAAOA,CAACD,KAAa,EAAE;AACrB,IAAA,IAAI,IAAI,CAACP,YAAY,KAAKO,KAAK,EAAE;MAC/B,IAAI,CAACR,eAAe,EAAE;AACxB;AACF;AAEAU,EAAAA,cAAcA,GAAG;IACf,IAAI,CAACT,YAAY,GAAG,IAAI;IACxB,IAAI,CAACD,eAAe,GAAG,CAAC;IACxB,IAAI,CAACD,KAAK,GAAG,UAAU;AACzB;EAEA,IAAIY,YAAYA,GAAG;IACjB,OAAO,IAAI,CAACZ,KAAK,KAAK,UAAU,IAAI,IAAI,CAACC,eAAe,GAAG,CAAC;AAC9D;AAEAY,EAAAA,KAAKA,GAAG;AACN,IAAA,OAAO,IAAId,KAAK,CAAC,IAAI,CAACK,KAAK,EAAE,IAAI,CAACC,EAAE,EAAE,IAAI,CAACC,KAAK,EAAE,IAAI,CAACC,KAAK,CAAC;AAC/D;AACF;;;;"}