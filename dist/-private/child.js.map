{"version":3,"file":"child.js","sources":["../../src/-private/child.ts"],"sourcesContent":["export default class Child<T = unknown> {\n  state: 'new' | 'kept' | 'removing' = 'new';\n  private removalBlockers = 0;\n  private removalCycle: number | null = null;\n\n  constructor(\n    readonly group: string,\n    readonly id: string,\n    readonly value: T,\n    readonly index: number,\n  ) {\n    this.removalBlockers = 0;\n    this.removalCycle = null;\n  }\n\n  block(cycle: number) {\n    if (this.removalCycle == null || this.removalCycle === cycle) {\n      this.removalCycle = cycle;\n      this.removalBlockers++;\n    }\n  }\n\n  unblock(cycle: number) {\n    if (this.removalCycle === cycle) {\n      this.removalBlockers--;\n    }\n  }\n\n  flagForRemoval() {\n    this.removalCycle = null;\n    this.removalBlockers = 0;\n    this.state = 'removing';\n  }\n\n  get shouldRemove() {\n    return this.state === 'removing' && this.removalBlockers < 1;\n  }\n\n  clone() {\n    return new Child(this.group, this.id, this.value, this.index);\n  }\n}\n"],"names":["Child","constructor","group","id","value","index","_defineProperty","removalBlockers","removalCycle","block","cycle","unblock","flagForRemoval","state","shouldRemove","clone"],"mappings":";;AAAe,MAAMA,KAAK,CAAc;EAKtCC,WAAWA,CACAC,KAAa,EACbC,EAAU,EACVC,KAAQ,EACRC,KAAa,EACtB;AAAAC,IAAAA,eAAA,gBATmC,KAAK,CAAA,CAAA;AAAAA,IAAAA,eAAA,0BAChB,CAAC,CAAA,CAAA;AAAAA,IAAAA,eAAA,uBACW,IAAI,CAAA,CAAA;IAAA,IAG/BJ,CAAAA,KAAa,GAAbA,KAAa,CAAA;IAAA,IACbC,CAAAA,EAAU,GAAVA,EAAU,CAAA;IAAA,IACVC,CAAAA,KAAQ,GAARA,KAAQ,CAAA;IAAA,IACRC,CAAAA,KAAa,GAAbA,KAAa,CAAA;IAEtB,IAAI,CAACE,eAAe,GAAG,CAAC,CAAA;IACxB,IAAI,CAACC,YAAY,GAAG,IAAI,CAAA;AAC1B,GAAA;EAEAC,KAAKA,CAACC,KAAa,EAAE;IACnB,IAAI,IAAI,CAACF,YAAY,IAAI,IAAI,IAAI,IAAI,CAACA,YAAY,KAAKE,KAAK,EAAE;MAC5D,IAAI,CAACF,YAAY,GAAGE,KAAK,CAAA;MACzB,IAAI,CAACH,eAAe,EAAE,CAAA;AACxB,KAAA;AACF,GAAA;EAEAI,OAAOA,CAACD,KAAa,EAAE;AACrB,IAAA,IAAI,IAAI,CAACF,YAAY,KAAKE,KAAK,EAAE;MAC/B,IAAI,CAACH,eAAe,EAAE,CAAA;AACxB,KAAA;AACF,GAAA;AAEAK,EAAAA,cAAcA,GAAG;IACf,IAAI,CAACJ,YAAY,GAAG,IAAI,CAAA;IACxB,IAAI,CAACD,eAAe,GAAG,CAAC,CAAA;IACxB,IAAI,CAACM,KAAK,GAAG,UAAU,CAAA;AACzB,GAAA;EAEA,IAAIC,YAAYA,GAAG;IACjB,OAAO,IAAI,CAACD,KAAK,KAAK,UAAU,IAAI,IAAI,CAACN,eAAe,GAAG,CAAC,CAAA;AAC9D,GAAA;AAEAQ,EAAAA,KAAKA,GAAG;AACN,IAAA,OAAO,IAAIf,KAAK,CAAC,IAAI,CAACE,KAAK,EAAE,IAAI,CAACC,EAAE,EAAE,IAAI,CAACC,KAAK,EAAE,IAAI,CAACC,KAAK,CAAC,CAAA;AAC/D,GAAA;AACF;;;;"}