{"version":3,"file":"color-GikOQVbN.js","sources":["../src/color.ts"],"sourcesContent":["import Tween from './-private/tween.ts';\nimport linear from './easings/linear.ts';\n\n// We use Element.remove in our color parser below.\nimport './element-remove.ts';\n\nexport class Color {\n  static fromComputedStyle(colorString: string) {\n    let channels = parseComputedColor(colorString);\n    return new Color(channels, channels.m[0]);\n  }\n  static fromUserProvidedColor(colorString: string) {\n    return new Color(parseUserProvidedColor(colorString), colorString);\n  }\n\n  toString() {\n    return `rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`;\n  }\n\n  readonly r: number;\n  readonly g: number;\n  readonly b: number;\n  readonly a: number;\n\n  constructor(\n    { r, g, b, a }: { r: number; g: number; b: number; a: number },\n    readonly sourceString: string,\n  ) {\n    this.r = r;\n    this.g = g;\n    this.b = b;\n    this.a = a;\n  }\n}\n\nexport class ColorTween {\n  private rTween: Tween;\n  private gTween: Tween;\n  private bTween: Tween;\n  private aTween: Tween;\n\n  constructor(\n    initialColor: Color,\n    finalColor: Color,\n    duration: number,\n    easing: (time: number) => number = linear,\n  ) {\n    this.rTween = new Tween(\n      initialColor.r * initialColor.a,\n      finalColor.r * finalColor.a,\n      duration,\n      easing,\n    );\n    this.gTween = new Tween(\n      initialColor.g * initialColor.a,\n      finalColor.g * finalColor.a,\n      duration,\n      easing,\n    );\n    this.bTween = new Tween(\n      initialColor.b * initialColor.a,\n      finalColor.b * finalColor.a,\n      duration,\n      easing,\n    );\n    this.aTween = new Tween(initialColor.a, finalColor.a, duration, easing);\n  }\n  get currentValue() {\n    let nonZeroAlpha = this.aTween.currentValue || 1;\n    return new Color(\n      {\n        r: Math.floor(this.rTween.currentValue / nonZeroAlpha),\n        g: Math.floor(this.gTween.currentValue / nonZeroAlpha),\n        b: Math.floor(this.bTween.currentValue / nonZeroAlpha),\n        a: this.aTween.currentValue,\n      },\n      '',\n    );\n  }\n  get done() {\n    return [this.rTween, this.gTween, this.bTween, this.aTween].every(\n      (tween) => tween.done,\n    );\n  }\n}\n\nfunction parseComputedColor(c: string) {\n  let m = /^rgb\\((\\d+), (\\d+), (\\d+)\\)/.exec(c);\n  if (m) {\n    return {\n      r: parseInt(m[1]!),\n      g: parseInt(m[2]!),\n      b: parseInt(m[3]!),\n      a: 1,\n      m,\n    };\n  }\n  m = /^rgba\\((\\d+), (\\d+), (\\d+), (\\d+(?:\\.\\d+)?)\\)/.exec(c);\n  if (m) {\n    return {\n      r: parseInt(m[1]!),\n      g: parseInt(m[2]!),\n      b: parseInt(m[3]!),\n      a: parseFloat(m[4]!),\n      m,\n    };\n  }\n  throw new Error(`unable to parse color ${c}`);\n}\n\nfunction parseUserProvidedColor(c: string) {\n  let testElement = document.createElement('div');\n  testElement.style.display = 'none';\n  testElement.style.color = c;\n  document.body.appendChild(testElement);\n  let result = parseComputedColor(getComputedStyle(testElement).color!);\n  testElement.remove();\n  return result;\n}\n"],"names":["Color","fromComputedStyle","colorString","channels","parseComputedColor","m","fromUserProvidedColor","parseUserProvidedColor","toString","r","g","b","a","constructor","sourceString","_defineProperty","ColorTween","initialColor","finalColor","duration","easing","linear","rTween","Tween","gTween","bTween","aTween","currentValue","nonZeroAlpha","Math","floor","done","every","tween","c","exec","parseInt","parseFloat","Error","testElement","document","createElement","style","display","color","body","appendChild","result","getComputedStyle","remove"],"mappings":"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"}