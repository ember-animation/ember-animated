{"version":3,"file":"color-DWpDqA22.js","sources":["../src/color.ts"],"sourcesContent":["import Tween from './-private/tween.ts';\nimport linear from './easings/linear.ts';\n\n// We use Element.remove in our color parser below.\nimport './element-remove.ts';\n\nexport class Color {\n  static fromComputedStyle(colorString: string) {\n    let channels = parseComputedColor(colorString);\n    return new Color(channels, channels.m[0]);\n  }\n  static fromUserProvidedColor(colorString: string) {\n    return new Color(parseUserProvidedColor(colorString), colorString);\n  }\n\n  toString() {\n    return `rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`;\n  }\n\n  readonly r: number;\n  readonly g: number;\n  readonly b: number;\n  readonly a: number;\n\n  constructor(\n    { r, g, b, a }: { r: number; g: number; b: number; a: number },\n    readonly sourceString: string,\n  ) {\n    this.r = r;\n    this.g = g;\n    this.b = b;\n    this.a = a;\n  }\n}\n\nexport class ColorTween {\n  private rTween: Tween;\n  private gTween: Tween;\n  private bTween: Tween;\n  private aTween: Tween;\n\n  constructor(\n    initialColor: Color,\n    finalColor: Color,\n    duration: number,\n    easing: (time: number) => number = linear,\n  ) {\n    this.rTween = new Tween(\n      initialColor.r * initialColor.a,\n      finalColor.r * finalColor.a,\n      duration,\n      easing,\n    );\n    this.gTween = new Tween(\n      initialColor.g * initialColor.a,\n      finalColor.g * finalColor.a,\n      duration,\n      easing,\n    );\n    this.bTween = new Tween(\n      initialColor.b * initialColor.a,\n      finalColor.b * finalColor.a,\n      duration,\n      easing,\n    );\n    this.aTween = new Tween(initialColor.a, finalColor.a, duration, easing);\n  }\n  get currentValue() {\n    let nonZeroAlpha = this.aTween.currentValue || 1;\n    return new Color(\n      {\n        r: Math.floor(this.rTween.currentValue / nonZeroAlpha),\n        g: Math.floor(this.gTween.currentValue / nonZeroAlpha),\n        b: Math.floor(this.bTween.currentValue / nonZeroAlpha),\n        a: this.aTween.currentValue,\n      },\n      '',\n    );\n  }\n  get done() {\n    return [this.rTween, this.gTween, this.bTween, this.aTween].every(\n      (tween) => tween.done,\n    );\n  }\n}\n\nfunction parseComputedColor(c: string) {\n  let m = /^rgb\\((\\d+), (\\d+), (\\d+)\\)/.exec(c);\n  if (m) {\n    return {\n      r: parseInt(m[1]!),\n      g: parseInt(m[2]!),\n      b: parseInt(m[3]!),\n      a: 1,\n      m,\n    };\n  }\n  m = /^rgba\\((\\d+), (\\d+), (\\d+), (\\d+(?:\\.\\d+)?)\\)/.exec(c);\n  if (m) {\n    return {\n      r: parseInt(m[1]!),\n      g: parseInt(m[2]!),\n      b: parseInt(m[3]!),\n      a: parseFloat(m[4]!),\n      m,\n    };\n  }\n  throw new Error(`unable to parse color ${c}`);\n}\n\nfunction parseUserProvidedColor(c: string) {\n  let testElement = document.createElement('div');\n  testElement.style.display = 'none';\n  testElement.style.color = c;\n  document.body.appendChild(testElement);\n  let result = parseComputedColor(getComputedStyle(testElement).color!);\n  testElement.remove();\n  return result;\n}\n"],"names":["Color","fromComputedStyle","colorString","channels","parseComputedColor","m","fromUserProvidedColor","parseUserProvidedColor","toString","r","g","b","a","constructor","sourceString","ColorTween","rTween","gTween","bTween","aTween","initialColor","finalColor","duration","easing","linear","Tween","currentValue","nonZeroAlpha","Math","floor","done","every","tween","c","exec","parseInt","parseFloat","Error","testElement","document","createElement","style","display","color","body","appendChild","result","getComputedStyle","remove"],"mappings":"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"}